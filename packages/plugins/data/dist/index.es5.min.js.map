{"version":3,"file":"index.es5.min.js","sources":["DataPlugin.js","serializer/JSON.js","serializer/Boolean.js","serializer/Number.js","DataDecorator.js"],"sourcesContent":["import { addGondelPluginEventListener } from '@gondel/core';\nexport var areDataBindingsHookedIntoCore = false;\nexport function hookDataDecoratorIntoCore() {\n    areDataBindingsHookedIntoCore = true;\n    addGondelPluginEventListener('Data', 'start', function (gondelComponents, _, next) {\n        gondelComponents.forEach(function (gondelComponent) {\n            var componentDataBindings = (gondelComponent.prototype && gondelComponent.prototype.__dataBindings) ||\n                gondelComponent.__dataBindings;\n            if (!componentDataBindings || componentDataBindings.length === 0) {\n                return next(gondelComponents);\n            }\n            componentDataBindings.forEach(function (_a) {\n                var propertyKey = _a[0], attributeKey = _a[1], serializer = _a[2];\n                var initialValue = gondelComponent[propertyKey];\n                Object.defineProperty(gondelComponent, propertyKey, {\n                    enumerable: true,\n                    configurable: false,\n                    get: function () {\n                        var value = gondelComponent._ctx.getAttribute(attributeKey);\n                        if (serializer && value !== null) {\n                            return serializer.deserialize(value);\n                        }\n                        return value;\n                    },\n                    set: function (value) {\n                        if (value === undefined) {\n                            gondelComponent._ctx.removeAttribute(attributeKey);\n                        }\n                        if (serializer) {\n                            value = serializer.serialize(value);\n                        }\n                        gondelComponent._ctx.setAttribute(attributeKey, value);\n                    },\n                });\n                if (initialValue) {\n                    gondelComponent[propertyKey] = gondelComponent[propertyKey] || initialValue;\n                    initialValue = undefined;\n                }\n            });\n        });\n        next(gondelComponents);\n    });\n}\n//# sourceMappingURL=DataPlugin.js.map","export var serialize = function (value) { return JSON.stringify(value); };\nexport var deserialize = function (value) { return JSON.parse(value); };\nexport default {\n    serialize: serialize,\n    deserialize: deserialize,\n};\n//# sourceMappingURL=JSON.js.map","export var serialize = function (value) { return \"\".concat(value); };\nexport var deserialize = function (value) { return value === 'true'; };\nexport default {\n    serialize: serialize,\n    deserialize: deserialize,\n};\n//# sourceMappingURL=Boolean.js.map","export var serialize = function (value) { return \"\".concat(value); };\nexport var deserialize = function (value) { return parseFloat(value); };\nexport default {\n    serialize: serialize,\n    deserialize: deserialize,\n};\n//# sourceMappingURL=Number.js.map","import { areDataBindingsHookedIntoCore, hookDataDecoratorIntoCore } from './DataPlugin';\nexport function data(targetOrAttributeKey, propertyKeyOrSerializer) {\n    // First case will be used if we have a custom attribute and a valid serializer (which is typeof ISerializer)\n    if (typeof targetOrAttributeKey === 'string' && typeof propertyKeyOrSerializer !== 'string') {\n        var customAttributeKey_1 = targetOrAttributeKey;\n        var serializer_1 = propertyKeyOrSerializer;\n        return function (target, propertyKey) {\n            if (!areDataBindingsHookedIntoCore) {\n                // prevent multiple hook listeners\n                hookDataDecoratorIntoCore();\n            }\n            if (!target.__dataBindings) {\n                target.__dataBindings = [];\n            }\n            var attributeKey = \"data-\".concat(customAttributeKey_1);\n            target.__dataBindings.push([propertyKey, attributeKey, serializer_1]);\n        };\n    }\n    if (typeof targetOrAttributeKey === 'string' || typeof propertyKeyOrSerializer !== 'string') {\n        // this case should not occur, the only case could be a respec of the decorators\n        throw new Error('Unexpected usage of @data');\n    }\n    // We only have a simple decorator which will need to autobind values via prop-key\n    var target = targetOrAttributeKey;\n    var propertyKey = propertyKeyOrSerializer;\n    if (!areDataBindingsHookedIntoCore) {\n        // prevent multiple hook listeners\n        hookDataDecoratorIntoCore();\n    }\n    if (!target.__dataBindings) {\n        target.__dataBindings = [];\n    }\n    var attributeKey = convertPropertyKeyToDataAttributeKey(propertyKey);\n    target.__dataBindings.push([propertyKey, attributeKey, undefined]);\n}\n/**\n * Will convert any possible property to a valid data attribute\n * @param {string} propertyKey    the prop to convert\n */\nfunction convertPropertyKeyToDataAttributeKey(propertyKey) {\n    if (propertyKey.substr(0, 1) === '_') {\n        propertyKey = propertyKey.substr(1);\n    }\n    if (propertyKey.substr(0, 4) !== 'data') {\n        throw new Error(\"\".concat(propertyKey, \"\\\" has an invalid format please use @data dataSomeProp (data-some-prop) for valid bindings.\"));\n    }\n    return propertyKey.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase();\n}\n//# sourceMappingURL=DataDecorator.js.map"],"names":["areDataBindingsHookedIntoCore","hookDataDecoratorIntoCore","addGondelPluginEventListener","gondelComponents","_","next","forEach","gondelComponent","componentDataBindings","prototype","__dataBindings","length","_a","propertyKey","attributeKey","serializer","initialValue","Object","defineProperty","enumerable","configurable","get","value","_ctx","getAttribute","deserialize","set","undefined","removeAttribute","serialize","setAttribute","JSON$1","JSON","stringify","parse","Boolean","concat","Number","parseFloat","targetOrAttributeKey","propertyKeyOrSerializer","customAttributeKey_1","serializer_1","target","push","Error","substr","replace","toLowerCase","convertPropertyKeyToDataAttributeKey"],"mappings":"ySACO,IAAIA,GAAgC,EACpC,SAASC,IACZD,GAAgC,EAChCE,EAAAA,6BAA6B,OAAQ,QAAS,SAAUC,EAAkBC,EAAGC,GACzEF,EAAiBG,QAAQ,SAAUC,GAC/B,IAAIC,EAAyBD,EAAgBE,WAAaF,EAAgBE,UAAUC,gBAChFH,EAAgBG,eACpB,IAAKF,GAA0D,IAAjCA,EAAsBG,OAChD,OAAON,EAAKF,GAEhBK,EAAsBF,QAAQ,SAAUM,GACpC,IAAIC,EAAcD,EAAG,GAAIE,EAAeF,EAAG,GAAIG,EAAaH,EAAG,GAC3DI,EAAeT,EAAgBM,GACnCI,OAAOC,eAAeX,EAAiBM,EAAa,CAChDM,YAAY,EACZC,cAAc,EACdC,IAAK,WACD,IAAIC,EAAQf,EAAgBgB,KAAKC,aAAaV,GAC9C,OAAIC,GAAwB,OAAVO,EACPP,EAAWU,YAAYH,GAE3BA,CACX,EACAI,IAAK,SAAUJ,QACGK,IAAVL,GACAf,EAAgBgB,KAAKK,gBAAgBd,GAErCC,IACAO,EAAQP,EAAWc,UAAUP,IAEjCf,EAAgBgB,KAAKO,aAAahB,EAAcQ,EACpD,IAEAN,IACAT,EAAgBM,GAAeN,EAAgBM,IAAgBG,EAC/DA,OAAeW,EAEvB,EACJ,GACAtB,EAAKF,EACT,EACJ,CC1CO,IAEP4B,EAAe,CACXF,UAHmB,SAAUP,GAAS,OAAOU,KAAKC,UAAUX,EAAQ,EAIpEG,YAHqB,SAAUH,GAAS,OAAOU,KAAKE,MAAMZ,EAAQ,GCCtEa,EAAe,CACXN,UAHmB,SAAUP,GAAS,MAAO,GAAGc,OAAOd,EAAQ,EAI/DG,YAHqB,SAAUH,GAAS,MAAiB,SAAVA,CAAkB,GCCrEe,EAAe,CACXR,UAHmB,SAAUP,GAAS,MAAO,GAAGc,OAAOd,EAAQ,EAI/DG,YAHqB,SAAUH,GAAS,OAAOgB,WAAWhB,EAAQ,wECA/D,SAAciB,EAAsBC,GAEvC,GAAoC,iBAAzBD,GAAwE,iBAA5BC,EAAsC,CACzF,IAAIC,EAAuBF,EACvBG,EAAeF,EACnB,OAAO,SAAUG,EAAQ9B,GAChBb,GAEDC,IAEC0C,EAAOjC,iBACRiC,EAAOjC,eAAiB,IAE5B,IAAII,EAAe,QAAQsB,OAAOK,GAClCE,EAAOjC,eAAekC,KAAK,CAAC/B,EAAaC,EAAc4B,GAC3D,CACJ,CACA,GAAoC,iBAAzBH,GAAwE,iBAA5BC,EAEnD,MAAM,IAAIK,MAAM,6BAGpB,IAAIF,EAASJ,EACT1B,EAAc2B,EACbxC,GAEDC,IAEC0C,EAAOjC,iBACRiC,EAAOjC,eAAiB,IAE5B,IAAII,EAOR,SAA8CD,GACT,MAA7BA,EAAYiC,OAAO,EAAG,KACtBjC,EAAcA,EAAYiC,OAAO,IAErC,GAAiC,SAA7BjC,EAAYiC,OAAO,EAAG,GACtB,MAAM,IAAID,MAAM,GAAGT,OAAOvB,EAAa,+FAE3C,OAAOA,EAAYkC,QAAQ,uBAAwB,OAAOC,aAC9D,CAfuBC,CAAqCpC,GACxD8B,EAAOjC,eAAekC,KAAK,CAAC/B,EAAaC,OAAca,GAC3D"}