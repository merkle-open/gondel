{"version":3,"file":"index.es5.js","sources":["DataPlugin.js","DataDecorator.js","serializer/JSON.js","serializer/Boolean.js","serializer/Number.js"],"sourcesContent":["import { addGondelPluginEventListener } from '@gondel/core';\r\nexport var areDataBindingsHookedIntoCore = false;\r\nexport function hookDataDecoratorIntoCore() {\r\n    areDataBindingsHookedIntoCore = true;\r\n    addGondelPluginEventListener('Data', 'start', function (gondelComponents, _, next) {\r\n        gondelComponents.forEach(function (gondelComponent) {\r\n            var componentDataBindings = (gondelComponent.prototype && gondelComponent.prototype.__dataBindings) ||\r\n                gondelComponent.__dataBindings;\r\n            if (!componentDataBindings || componentDataBindings.length === 0) {\r\n                return next(gondelComponents);\r\n            }\r\n            componentDataBindings.forEach(function (_a) {\r\n                var propertyKey = _a[0], attributeKey = _a[1], serializer = _a[2];\r\n                var initialValue = gondelComponent[propertyKey];\r\n                Object.defineProperty(gondelComponent, propertyKey, {\r\n                    enumerable: true,\r\n                    configurable: false,\r\n                    get: function () {\r\n                        var value = gondelComponent._ctx.getAttribute(attributeKey);\r\n                        if (serializer && value !== null) {\r\n                            return serializer.deserialize(value);\r\n                        }\r\n                        return value;\r\n                    },\r\n                    set: function (value) {\r\n                        if (value === undefined) {\r\n                            gondelComponent._ctx.removeAttribute(attributeKey);\r\n                        }\r\n                        if (serializer) {\r\n                            value = serializer.serialize(value);\r\n                        }\r\n                        gondelComponent._ctx.setAttribute(attributeKey, value);\r\n                    },\r\n                });\r\n                if (initialValue) {\r\n                    gondelComponent[propertyKey] = gondelComponent[propertyKey] || initialValue;\r\n                    initialValue = undefined;\r\n                }\r\n            });\r\n        });\r\n        next(gondelComponents);\r\n    });\r\n}\r\n//# sourceMappingURL=DataPlugin.js.map","import { areDataBindingsHookedIntoCore, hookDataDecoratorIntoCore } from './DataPlugin';\r\nexport function data(targetOrAttributeKey, propertyKeyOrSerializer) {\r\n    // First case will be used if we have a custom attribute and a valid serializer (which is typeof ISerializer)\r\n    if (typeof targetOrAttributeKey === 'string' && typeof propertyKeyOrSerializer !== 'string') {\r\n        var customAttributeKey_1 = targetOrAttributeKey;\r\n        var serializer_1 = propertyKeyOrSerializer;\r\n        return function (target, propertyKey) {\r\n            if (!areDataBindingsHookedIntoCore) {\r\n                // prevent multiple hook listeners\r\n                hookDataDecoratorIntoCore();\r\n            }\r\n            if (!target.__dataBindings) {\r\n                target.__dataBindings = [];\r\n            }\r\n            var attributeKey = \"data-\" + customAttributeKey_1;\r\n            target.__dataBindings.push([propertyKey, attributeKey, serializer_1]);\r\n        };\r\n    }\r\n    if (typeof targetOrAttributeKey === 'string' || typeof propertyKeyOrSerializer !== 'string') {\r\n        // this case should not occur, the only case could be a respec of the decorators\r\n        throw new Error('Unexpected usage of @data');\r\n    }\r\n    // We only have a simple decorator which will need to autobind values via prop-key\r\n    var target = targetOrAttributeKey;\r\n    var propertyKey = propertyKeyOrSerializer;\r\n    if (!areDataBindingsHookedIntoCore) {\r\n        // prevent multiple hook listeners\r\n        hookDataDecoratorIntoCore();\r\n    }\r\n    if (!target.__dataBindings) {\r\n        target.__dataBindings = [];\r\n    }\r\n    var attributeKey = convertPropertyKeyToDataAttributeKey(propertyKey);\r\n    target.__dataBindings.push([propertyKey, attributeKey, undefined]);\r\n}\r\n/**\r\n * Will convert any possible property to a valid data attribute\r\n * @param {string} propertyKey    the prop to convert\r\n */\r\nfunction convertPropertyKeyToDataAttributeKey(propertyKey) {\r\n    if (propertyKey.substr(0, 1) === '_') {\r\n        propertyKey = propertyKey.substr(1);\r\n    }\r\n    if (propertyKey.substr(0, 4) !== 'data') {\r\n        throw new Error(propertyKey + \"\\\" has an invalid format please use @data dataSomeProp (data-some-prop) for valid bindings.\");\r\n    }\r\n    return propertyKey.replace(/([a-zA-Z])(?=[A-Z])/g, '$1-').toLowerCase();\r\n}\r\n//# sourceMappingURL=DataDecorator.js.map","export var serialize = function (value) { return JSON.stringify(value); };\r\nexport var deserialize = function (value) { return JSON.parse(value); };\r\nexport default {\r\n    serialize: serialize,\r\n    deserialize: deserialize,\r\n};\r\n//# sourceMappingURL=JSON.js.map","export var serialize = function (value) { return \"\" + value; };\r\nexport var deserialize = function (value) { return value === 'true'; };\r\nexport default {\r\n    serialize: serialize,\r\n    deserialize: deserialize,\r\n};\r\n//# sourceMappingURL=Boolean.js.map","export var serialize = function (value) { return \"\" + value; };\r\nexport var deserialize = function (value) { return parseFloat(value); };\r\nexport default {\r\n    serialize: serialize,\r\n    deserialize: deserialize,\r\n};\r\n//# sourceMappingURL=Number.js.map"],"names":["addGondelPluginEventListener","serialize","deserialize"],"mappings":"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"}